import{m as y,n as V,v as k,u as m,o as c,c as p,p as h,q as x,r as f,s as I,x as C,g as M,a as n,F as S,y as T,z as U,b as g,w as B,t as j,d as $,A as N}from"./BFI96TAX.js";import{u as z,c as A,_ as D}from"./WuMrV7d6.js";const E=y({__name:"Input",props:{defaultValue:{},modelValue:{},class:{}},emits:["update:modelValue"],setup(u,{emit:e}){const r=u,t=z(r,"modelValue",e,{passive:!0,defaultValue:r.defaultValue});return(s,l)=>V((c(),p("input",{"onUpdate:modelValue":l[0]||(l[0]=b=>x(t)?t.value=b:null),class:h(m(A)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r.class))},null,2)),[[k,m(t)]])}});function F(){const u=I(),e=f([]);return{messages:e,sendMessage:async(o,t)=>{try{e.value.push({role:"user",text:t});const s=e.value.length;e.value.push({role:"bot",text:"Waiting for response..."});const l=await $fetch(`${u.public.apiBase}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:{user_id:o,input:t}});return e.value[s]={role:"bot",text:l.response},l.response}catch(s){console.error("Chat API error:",s),e.value.push({role:"bot",text:"Error: Could not get response."})}}}}const P={class:"flex flex-col p-3 h-screen w-full bg-black text-white"},R={class:"flex flex-col h-full border-2 border-white rounded-lg bg-black"},q={class:"p-3 text-lg border-2 border-white font-bold rounded-lg text-white max-w-full break-words whitespace-pre-wrap bg-gray-950"},H={class:"border-t-2 border-white p-4 bg-black rounded-b-lg"},W={__name:"chat",setup(u){const{messages:e,sendMessage:r}=F(),o=f(""),t=f(null),s=f("");function l(){return"user-"+Math.random().toString(36).slice(2,11)}C(()=>{const a=localStorage.getItem("chatUserId");a?s.value=a:(s.value=l(),localStorage.setItem("chatUserId",s.value))}),M(e,async()=>{await N(),t.value&&(t.value.scrollTop=t.value.scrollHeight)},{deep:!0});async function b(){const a=o.value.trim();a&&(o.value="",await r(s.value,a))}return(a,d)=>{const v=E,_=D;return c(),p("div",P,[n("div",R,[n("div",{ref_key:"chatContainer",ref:t,class:"flex-1 overflow-y-auto space-y-4 bg-black rounded-t-lg p-3"},[(c(!0),p(S,null,T(m(e),(i,w)=>(c(),p("div",{key:w,class:h(["flex p-3",i.role==="user"?"justify-end":"justify-start"])},[n("div",q,[n("p",null,j(i.text),1)])],2))),128))],512),n("div",H,[n("form",{onSubmit:U(b,["prevent"]),class:"flex"},[g(v,{modelValue:m(o),"onUpdate:modelValue":d[0]||(d[0]=i=>x(o)?o.value=i:null),placeholder:"Type your message...",class:"flex-1 mr-2 bg-black text-white border-2 border-white placeholder-white rounded-lg text-2xl p-2 placeholder:text-2xl h-12 leading-12"},null,8,["modelValue"]),g(_,{type:"submit",variant:"default",class:"border-white rounded-lg p-2 h-12 flex items-center justify-center text-2xl"},{default:B(()=>d[1]||(d[1]=[$(" Send ")])),_:1})],32)])])])}}};export{W as default};
